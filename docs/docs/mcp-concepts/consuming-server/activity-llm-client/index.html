<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-mcp-concepts/consuming-server/activity-llm-client" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Activity: Create an MCP client using LLM | MCP Workshop</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://softchris.github.io/mcp-workshop/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://softchris.github.io/mcp-workshop/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://softchris.github.io/mcp-workshop/docs/mcp-concepts/consuming-server/activity-llm-client"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Activity: Create an MCP client using LLM | MCP Workshop"><meta data-rh="true" name="description" content="Let&#x27;s add an LLM and ensure the LLM is what&#x27;s between the user and the server. Here&#x27;s how it will work on high level:"><meta data-rh="true" property="og:description" content="Let&#x27;s add an LLM and ensure the LLM is what&#x27;s between the user and the server. Here&#x27;s how it will work on high level:"><link data-rh="true" rel="icon" href="/mcp-workshop/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://softchris.github.io/mcp-workshop/docs/mcp-concepts/consuming-server/activity-llm-client"><link data-rh="true" rel="alternate" href="https://softchris.github.io/mcp-workshop/docs/mcp-concepts/consuming-server/activity-llm-client" hreflang="en"><link data-rh="true" rel="alternate" href="https://softchris.github.io/mcp-workshop/docs/mcp-concepts/consuming-server/activity-llm-client" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/mcp-workshop/blog/rss.xml" title="MCP Workshop RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/mcp-workshop/blog/atom.xml" title="MCP Workshop Atom Feed"><link rel="stylesheet" href="/mcp-workshop/assets/css/styles.b8d2aa6b.css">
<script src="/mcp-workshop/assets/js/runtime~main.e6ecd0ff.js" defer="defer"></script>
<script src="/mcp-workshop/assets/js/main.39b0ef7a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/mcp-workshop/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/mcp-workshop/"><div class="navbar__logo"><img src="/mcp-workshop/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/mcp-workshop/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">MCP Workshop</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/mcp-workshop/docs/category/mcp-concepts">Tutorial</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/mcp-workshop/docs/category/mcp-concepts">MCP Concepts</a><button aria-label="Collapse sidebar category &#x27;MCP Concepts&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/mcp-workshop/docs/category/getting-started">Getting started</a><button aria-label="Expand sidebar category &#x27;Getting started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/mcp-workshop/docs/category/consuming-a-server">Consuming a server</a><button aria-label="Collapse sidebar category &#x27;Consuming a server&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mcp-workshop/docs/mcp-concepts/consuming-server/vscode">Consuming a server with Visual Studio Code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mcp-workshop/docs/mcp-concepts/consuming-server/activity-vscode">Activity: Consume server with Visual Studio Code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mcp-workshop/docs/mcp-concepts/consuming-server/client">Consuming a server with an MCP client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mcp-workshop/docs/mcp-concepts/consuming-server/activity-client">Activity: Creating a client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mcp-workshop/docs/mcp-concepts/consuming-server/llm-client">LLM Client</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/mcp-workshop/docs/mcp-concepts/consuming-server/activity-llm-client">Activity: Create an MCP client using LLM</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/mcp-workshop/docs/category/sse-servers">SSE Servers</a><button aria-label="Expand sidebar category &#x27;SSE Servers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/mcp-workshop/docs/category/what-else">What else?</a><button aria-label="Expand sidebar category &#x27;What else?&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/mcp-workshop/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/mcp-workshop/docs/category/mcp-concepts"><span itemprop="name">MCP Concepts</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/mcp-workshop/docs/category/consuming-a-server"><span itemprop="name">Consuming a server</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Activity: Create an MCP client using LLM</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Activity: Create an MCP client using LLM</h1></header>
<p>Let&#x27;s add an LLM and ensure the LLM is what&#x27;s between the user and the server. Here&#x27;s how it will work on high level:</p>
<ol>
<li>The client will call the server and get information about its tools. Based on this response, the client will remember the tools and their parameters.</li>
<li>The user then asks the client a question which in turn will call the LLM to get a response. If the LLM deems it necessary, it will call the server&#x27;s tools to get more information.</li>
</ol>
<p>Next, let&#x27;s implement this in code.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-1--create-a-client-file">-1- Create a client file<a href="#-1--create-a-client-file" class="hash-link" aria-label="Direct link to -1- Create a client file" title="Direct link to -1- Create a client file">â€‹</a></h2>
<p>Use your existing Node.js project but add a <code>Client.ts</code> file.</p>
<ol>
<li>
<p>Add the following code to <code>Client.ts</code>:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"> Client </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;@modelcontextprotocol/sdk/client/index.js&quot;</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"> StdioClientTransport </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;@modelcontextprotocol/sdk/client/stdio.js&quot;</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"> Transport </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;@modelcontextprotocol/sdk/shared/transport.js&quot;</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> OpenAI </span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;openai&quot;</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"> z </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;zod&quot;</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"> </span><span class="token comment" style="color:#6A9955">// Import zod for schema validation</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Now you have all the imports you need including OpenAI and you&#x27;ve instantiated an openai client. Next, let&#x27;s add code to create the client and connect to the server.</p>
</li>
<li>
<p>Add the following code to create a client class:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token keyword" style="color:#0c4a6e">class</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">MCPClient</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">private</span><span class="token plain"> openai</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> OpenAI</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">private</span><span class="token plain"> client</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> Client</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token function" style="color:#0e7490">constructor</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">openai </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">OpenAI</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            baseURL</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;https://models.inference.ai.azure.com&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            apiKey</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> process</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">env</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">GITHUB_TOKEN</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">client </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">Client</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                name</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;example-client&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                version</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;1.0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                capabilities</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                prompts</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                resources</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                tools</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In the preceding code:</p>
<ul>
<li><code>MCPClient</code> is defined as a class that will handle the connection to the server and the LLM.</li>
<li>A constructor is defined that initializes the OpenAI client and the MCP client. The OpenAI client is initialized with the base URL and API key. The MCP client is initialized with the name and version.</li>
</ul>
<p>Great, we now have a client that can connect to the server. Next, let&#x27;s add more code to wire up the LLM and the server.</p>
</li>
<li>
<p>Add the following so we can connect to the server:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token keyword" style="color:#0c4a6e">async</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">connectToServer</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">transport</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> Transport</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">     </span><span class="token keyword" style="color:#0c4a6e">await</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">connect</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">transport</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">     </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">run</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">     </span><span class="token builtin" style="color:#0c4a6e">console</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">error</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;MCPClient started on stdin/stdout&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It doesn&#x27;t do much other than connect to the server and run the client.</p>
</li>
<li>
<p>Let&#x27;s add the following code to help us convert an MCP tool response into a tool an LLM can understand:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token function" style="color:#0e7490">openAiToolAdapter</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">tool</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">     name</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">string</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">     description</span><span class="token operator" style="color:#475569">?</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">string</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">     input_schema</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">any</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">       </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">       </span><span class="token comment" style="color:#6A9955">// Create a zod schema based on the input_schema</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">       </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> schema </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> z</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">object</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">tool</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">input_schema</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">   </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">       </span><span class="token keyword" style="color:#0c4a6e">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">         type</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;function&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">as</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token comment" style="color:#6A9955">// Explicitly set type to &quot;function&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">         </span><span class="token keyword" style="color:#0c4a6e">function</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">           name</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> tool</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">           description</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> tool</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">description</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">           parameters</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">           type</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;object&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">           properties</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> tool</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">input_schema</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">properties</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">           required</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> tool</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">input_schema</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">required</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">           </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">         </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">       </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token punctuation" style="color:#475569">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Next, let&#x27;s add a function that lets us process a response from an LLM and make a tool call if the LLM indicates a tool should be called:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token keyword" style="color:#0c4a6e">async</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">callTools</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    tool_calls</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> OpenAI</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">Chat</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">Completions</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">ChatCompletionMessageToolCall</span><span class="token punctuation" style="color:#475569">[</span><span class="token punctuation" style="color:#475569">]</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    toolResults</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">any</span><span class="token punctuation" style="color:#475569">[</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> tool_call </span><span class="token keyword" style="color:#0c4a6e">of</span><span class="token plain"> tool_calls</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> toolName </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> tool_call</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">function</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> args </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> tool_call</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">function</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">arguments</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token builtin" style="color:#0c4a6e">console</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">log</span><span class="token punctuation" style="color:#475569">(</span><span class="token template-string template-punctuation string" style="color:#64748b">`</span><span class="token template-string string" style="color:#64748b">Calling tool </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#475569">${</span><span class="token template-string interpolation">toolName</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#475569">}</span><span class="token template-string string" style="color:#64748b"> with args </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#475569">${</span><span class="token template-string interpolation constant" style="color:#0f172a">JSON</span><span class="token template-string interpolation punctuation" style="color:#475569">.</span><span class="token template-string interpolation function" style="color:#0e7490">stringify</span><span class="token template-string interpolation punctuation" style="color:#475569">(</span><span class="token template-string interpolation">args</span><span class="token template-string interpolation punctuation" style="color:#475569">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#475569">}</span><span class="token template-string template-punctuation string" style="color:#64748b">`</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token comment" style="color:#6A9955">// 2. Call the server&#x27;s tool </span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> toolResult </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">await</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">callTool</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        name</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> toolName</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        arguments</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token constant" style="color:#0f172a">JSON</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">parse</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">args</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token builtin" style="color:#0c4a6e">console</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">log</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;Tool result: &quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> toolResult</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token comment" style="color:#6A9955">// 3. Do something with the result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token comment" style="color:#6A9955">// TODO  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">     </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In the preceding code:</p>
<ul>
<li>The <code>callTools</code> function takes an array of tool calls and their results. It iterates over the tool calls, calling each tool on the server and logging the result.</li>
<li>See the part where we call <code>callTool</code> with a tool name and arguments. This is how we call a tool on the server. The result is then logged to the console.</li>
</ul>
</li>
<li>
<p>Finally, we add the function that sets everything up called <code>run</code></p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token keyword" style="color:#0c4a6e">async</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">run</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token builtin" style="color:#0c4a6e">console</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">log</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;Asking server for available tools&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> toolsResult </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">await</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">listTools</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> tools </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> toolsResult</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">tools</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">map</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">tool</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">return</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">openAiToolAdapter</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          name</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> tool</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          description</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> tool</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">description</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          input_schema</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> tool</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">inputSchema</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> messages</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> OpenAI</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">Chat</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">Completions</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">ChatCompletionMessageParam</span><span class="token punctuation" style="color:#475569">[</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            role</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;user&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            content</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;What is the sum of 2 and 3?&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">]</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token builtin" style="color:#0c4a6e">console</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">log</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;Querying LLM: &quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> messages</span><span class="token punctuation" style="color:#475569">[</span><span class="token number" style="color:#B5CEA8">0</span><span class="token punctuation" style="color:#475569">]</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">content</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">let</span><span class="token plain"> response </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">openai</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">chat</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">completions</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">create</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        model</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;gpt-4o-mini&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        max_tokens</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">1000</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        messages</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        tools</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> tools</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">let</span><span class="token plain"> results</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">any</span><span class="token punctuation" style="color:#475569">[</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token punctuation" style="color:#475569">]</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// 1. Go through the LLM response,for each choice, check if it has tool calls </span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">await</span><span class="token plain"> response</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">choices</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">map</span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">choice</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"> message</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">any</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> message </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> choice</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">message</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token keyword" style="color:#0c4a6e">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">tool_calls</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token builtin" style="color:#0c4a6e">console</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">log</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;Making tool call&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token keyword" style="color:#0c4a6e">await</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">callTools</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">tool_calls</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> results</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In the preceding code:</p>
<ul>
<li>The <code>run</code> function first queries the server for available tools and converts them into a format that the LLM can understand.</li>
<li>It then sends a message to the LLM asking for the sum of 2 and 3.</li>
<li>If the LLM indicates that a tool should be called, it calls the <code>callTools</code> function to handle the tool call.</li>
</ul>
</li>
</ol>
<p>Here&#x27;s the full code for reference:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"> Client </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;@modelcontextprotocol/sdk/client/index.js&quot;</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"> StdioClientTransport </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;@modelcontextprotocol/sdk/client/stdio.js&quot;</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"> Transport </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;@modelcontextprotocol/sdk/shared/transport.js&quot;</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> OpenAI </span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;openai&quot;</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"> z </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">from</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;zod&quot;</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"> </span><span class="token comment" style="color:#6A9955">// Import zod for schema validation</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">class</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">MyClient</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">private</span><span class="token plain"> openai</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> OpenAI</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">private</span><span class="token plain"> client</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> Client</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token function" style="color:#0e7490">constructor</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">openai </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">OpenAI</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            baseURL</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;https://models.inference.ai.azure.com&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token comment" style="color:#6A9955">// might need to change to this url in the future: https://models.github.ai/inference</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            apiKey</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> process</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">env</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">GITHUB_TOKEN</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">       </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">client </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">Client</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                name</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;example-client&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                version</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;1.0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                capabilities</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                prompts</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                resources</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                tools</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">async</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">connectToServer</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">transport</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> Transport</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">await</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">connect</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">transport</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">run</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token builtin" style="color:#0c4a6e">console</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">error</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;MCPClient started on stdin/stdout&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token function" style="color:#0e7490">openAiToolAdapter</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">tool</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        name</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">string</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        description</span><span class="token operator" style="color:#475569">?</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">string</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        input_schema</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">any</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token comment" style="color:#6A9955">// Create a zod schema based on the input_schema</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> schema </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> z</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">object</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">tool</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">input_schema</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token keyword" style="color:#0c4a6e">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            type</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;function&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">as</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token comment" style="color:#6A9955">// Explicitly set type to &quot;function&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token keyword" style="color:#0c4a6e">function</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">              name</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> tool</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">              description</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> tool</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">description</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">              parameters</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">              type</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;object&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">              properties</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> tool</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">input_schema</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">properties</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">              required</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> tool</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">input_schema</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">required</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">              </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">async</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">callTools</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        tool_calls</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> OpenAI</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">Chat</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">Completions</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">ChatCompletionMessageToolCall</span><span class="token punctuation" style="color:#475569">[</span><span class="token punctuation" style="color:#475569">]</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        toolResults</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">any</span><span class="token punctuation" style="color:#475569">[</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> tool_call </span><span class="token keyword" style="color:#0c4a6e">of</span><span class="token plain"> tool_calls</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> toolName </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> tool_call</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">function</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> args </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> tool_call</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">function</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">arguments</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token builtin" style="color:#0c4a6e">console</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">log</span><span class="token punctuation" style="color:#475569">(</span><span class="token template-string template-punctuation string" style="color:#64748b">`</span><span class="token template-string string" style="color:#64748b">Calling tool </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#475569">${</span><span class="token template-string interpolation">toolName</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#475569">}</span><span class="token template-string string" style="color:#64748b"> with args </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#475569">${</span><span class="token template-string interpolation constant" style="color:#0f172a">JSON</span><span class="token template-string interpolation punctuation" style="color:#475569">.</span><span class="token template-string interpolation function" style="color:#0e7490">stringify</span><span class="token template-string interpolation punctuation" style="color:#475569">(</span><span class="token template-string interpolation">args</span><span class="token template-string interpolation punctuation" style="color:#475569">)</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#475569">}</span><span class="token template-string template-punctuation string" style="color:#64748b">`</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token comment" style="color:#6A9955">// 2. Call the server&#x27;s tool </span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> toolResult </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">await</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">callTool</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            name</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> toolName</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            arguments</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token constant" style="color:#0f172a">JSON</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">parse</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">args</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token builtin" style="color:#0c4a6e">console</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">log</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;Tool result: &quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> toolResult</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token comment" style="color:#6A9955">// 3. Do something with the result</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token comment" style="color:#6A9955">// TODO  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">         </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">async</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">run</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token builtin" style="color:#0c4a6e">console</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">log</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;Asking server for available tools&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> toolsResult </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">await</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">listTools</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> tools </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> toolsResult</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">tools</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">map</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">tool</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token keyword" style="color:#0c4a6e">return</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">openAiToolAdapter</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">              name</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> tool</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">              description</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> tool</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">description</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">              input_schema</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> tool</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">inputSchema</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> messages</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> OpenAI</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">Chat</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">Completions</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">ChatCompletionMessageParam</span><span class="token punctuation" style="color:#475569">[</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                role</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;user&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                content</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;What is the sum of 2 and 3?&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">]</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token builtin" style="color:#0c4a6e">console</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">log</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;Querying LLM: &quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> messages</span><span class="token punctuation" style="color:#475569">[</span><span class="token number" style="color:#B5CEA8">0</span><span class="token punctuation" style="color:#475569">]</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">content</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">let</span><span class="token plain"> response </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">openai</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">chat</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">completions</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">create</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            model</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;gpt-4o-mini&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            max_tokens</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">1000</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            messages</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            tools</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> tools</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain">    </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">let</span><span class="token plain"> results</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">any</span><span class="token punctuation" style="color:#475569">[</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token punctuation" style="color:#475569">]</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">// 1. Go through the LLM response,for each choice, check if it has tool calls </span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">await</span><span class="token plain"> response</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">choices</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">map</span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">choice</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"> message</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token builtin" style="color:#0c4a6e">any</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token operator" style="color:#475569">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> message </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> choice</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">message</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token keyword" style="color:#0c4a6e">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">tool_calls</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">              </span><span class="token builtin" style="color:#0c4a6e">console</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">log</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;Making tool call&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">              </span><span class="token keyword" style="color:#0c4a6e">await</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">this</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">callTools</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">message</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">tool_calls</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> results</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">let</span><span class="token plain"> client </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">MyClient</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">const</span><span class="token plain"> transport </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">StdioClientTransport</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            command</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;node&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            args</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token string" style="color:#64748b">&quot;./build/index.js&quot;</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">connectToServer</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">transport</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>That&#x27;s it, now you have a working client.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="-2--run-the-client">-2- Run the client<a href="#-2--run-the-client" class="hash-link" aria-label="Direct link to -2- Run the client" title="Direct link to -2- Run the client">â€‹</a></h2>
<p>To test this client out, you&#x27;re recommended to add a task to your <em>package.json</em> called &quot;client&quot; that runs the client. This way you can run the client with <code>npm run client</code>.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;scripts&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token property">&quot;client&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;tsx node build/client.js&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Here&#x27;s a repository you can clone if you want to test this out:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">git clone https://github.com/softchris/tutorial-mcp.git</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">cd tutorial-mcp</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">npm run client</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see the following output:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">Asking server for available tools</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">Querying LLM:  What is the sum of 2 and 3?</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">Making tool call</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">Tool result:  { content: [ { type: &#x27;text&#x27;, text: &#x27;5&#x27; } ] }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/mcp-concepts/01-consuming-server/06-activity-llm-client.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/mcp-workshop/docs/mcp-concepts/consuming-server/llm-client"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">LLM Client</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/mcp-workshop/docs/category/sse-servers"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SSE Servers</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#-1--create-a-client-file" class="table-of-contents__link toc-highlight">-1- Create a client file</a></li><li><a href="#-2--run-the-client" class="table-of-contents__link toc-highlight">-2- Run the client</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/mcp-workshop/docs/category/mcp-concepts">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/mcp-workshop/docs/category/mcp-concepts">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>